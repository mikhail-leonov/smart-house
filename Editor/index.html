<!DOCTYPE html>
<!--
/**
 * SmartHub - AI powered Smart Home
 * App which is running and read rules and try to validate them with AI and send command to a Controller 
 * GitHub: https://github.com/mikhail-leonov/smart-house
 * 
 * @author Ivan Leonov ivanleonov1002@gmail.com 
 * @version 0.6.8
 * @license MIT
 */
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Management System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Building Management System</h1>
        
        <!-- Property Management -->
        <div class="section">
            <h2>Properties</h2>
            <div class="property-form">
                <input type="text" id="propertyName" placeholder="Property Name (e.g., temperature)">
                <select id="propertyType" onchange="toggleRangeInputs()">
                    <option value="">Select Type</option>
                    <option value="range">Range</option>
                    <option value="binary">Binary (On/Off)</option>
                </select>
                <div id="rangeInputs" style="display:none;">
                    <input type="number" id="minValue" placeholder="Min value">
                    <input type="number" id="maxValue" placeholder="Max value">
                </div>
                <button onclick="addProperty()">Add Property</button>
            </div>
            <div id="propertyList"></div>
            <button onclick="exportProperties()">Export Properties</button>
            <input type="file" id="importProperties" accept=".json" onchange="importProperties()">
        </div>

        <!-- Tree Management -->
        <div class="section">
            <h2>Building Structure</h2>
            <div id="tree">
                <div class="node">
                    <div class="node-header-container">
                        <div class="node-title-container">
                            <h3>Home</h3>
                        </div>
                        <span class="collapse-icon" onclick="toggleCollapse(this.parentElement)">+</span>
                    </div>
                    <div class="node-content">
                        <div class="controls">
                            <div class="left-buttons">
                                <button class="add-btn" onclick="openAddNodeModal('location', 'tree', 'locations', 2)">➕ Add House Area</button>
                            </div>
                        </div>
                        <div id="locations"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JSON Export -->
        <div class="section">
            <button onclick="exportTree()">Export Tree to JSON</button>
            <input type="file" id="importTree" accept=".json" onchange="importTree()">
        </div>

        <!-- Modal for Adding Nodes -->
        <div id="addNodeModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAddNodeModal()">×</span>
                <h2>Add New Node</h2>
                <form id="addNodeForm">
                    <label for="nodeName">Node Name:</label>
                    <input type="text" id="nodeName" required>
                    <input type="hidden" id="nodeType">
                    <input type="hidden" id="nodeParentId">
                    <input type="hidden" id="nodeParentElementId">
                    <input type="hidden" id="nodeLevel">
                    <input type="hidden" id="nodeId">
                    <button type="submit">Add</button>
                </form>
            </div>
        </div>

        <!-- Modal for Assigning Properties -->
        <div id="assignPropertyModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAssignPropertyModal()">×</span>
                <h2>Assign Property to Room</h2>
                <form id="assignPropertyForm">
                    <label for="propertySelect">Property:</label>
                    <select id="propertySelect" required>
                        <option value="">Select Property</option>
                    </select>
                    <input type="hidden" id="roomId">
                    <button type="submit">Assign</button>
                </form>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>