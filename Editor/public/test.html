<!DOCTYPE html>
<!-- 
/**
 * SmartHub - AI powered Smart Home
 * UI App which is reads values from MQTT and show them to user
 * GitHub: https://github.com/mikhail-leonov/smart-house
 * 
 * @author Mikhail Leonov mikecommon@gmail.com
 * @version 0.7.1
 * @license MIT
 */
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Home Config</title>
  <link href="/shared/bootstrap.min.css" rel="stylesheet">
  <link href="/shared/ui.css" rel="stylesheet">
  <link href="/shared/home.css" rel="stylesheet">
  <link href="/shared/bootstrap-icons.css" rel="stylesheet">
</head>
<body>

  <div class="container container-no-left">
    <div class="sidebar">
      <h2>Smart Home</h2>
      <ul>
        <li class="nav-item" onclick="showSection('sensors')">Sensors</li>
        <li class="nav-item" onclick="showSection('tree')">Tree</li>
        <li class="nav-item" onclick="showSection('config')">Config</li>
      </ul>
    </div>
    <div class="main-content">
      <div class="dashboard-header">
        <h1>Smart Home Config</h1>
        <div id="current-time"></div>
      </div>

      <div id="sensors" class="section" style="display: none;">
		<div class="d-flex justify-content-between align-items-center mb-3">
			<h4 class="mb-0">Add / Edit Sensor</h4>
			<div class="d-flex gap-2">
				<button type="button" class="btn btn-secondary" onclick="exportSensors()">Export JSON</button>
				<button type="button" class="btn btn-secondary" onclick="document.getElementById('importSensorsFileInput').click()">Import JSON</button>
			</div>
			<input type="file" id="importSensorsFileInput" accept=".json" style="display:none" onchange="importSensors(event)">			
		</div>
        <form id="sensorForm" class="row gx-2 align-items-end">
          <div class="row">
            <div class="col-md-2">
              <label for="sensorName" class="form-label">Name</label>
              <input type="text" class="form-control" id="sensorName" required>
            </div>
            <div class="col-md-2">
              <label for="sensorDesc" class="form-label">Description</label>
              <input type="text" class="form-control" id="sensorDesc" required>
            </div>
            <div class="col-md-2">
              <div id="actionsInputs">
				<label for="sensorActions" class="form-label">Actions</label>
				<input type="text" id="sensorActions" class="form-control" placeholder="start, stop, reset" />		
              </div>
            </div>
            <div class="col-md-2">
              <label for="sensorType" class="form-label">Type</label>
              <select id="sensorType" class="form-control" onchange="toggleRangeInputs()">
                <option value="">Select Type</option>
                <option value="range">Range</option>
                <option value="binary">Binary (On/Off)</option>
                <option value="list">List</option>
              </select>
            </div>
            <div class="col-md-4">
              <div id="rangeInputs" style="display:none;">
                <label class="form-label d-block">Range</label>
                <div class="row gx-4">
                  <div class="col">
                    <input type="number" class="form-control" id="minValue" placeholder="Min value">
                  </div>
                  <div class="col">
                    <input type="number" class="form-control" id="maxValue" placeholder="Max value">
                  </div>
                </div>
              </div>
              <div id="listInputs" style="display:none;">
                <label class="form-label d-block">List</label>
                <input type="text" class="form-control" id="listOptions" placeholder="Comma-separated options (e.g., Low,Medium,High)">
              </div>
            </div>
            <div class="col-md-1 d-flex align-items-end">
              <button type="button" id="addBtn" onclick="createSensor()" class="btn btn-primary w-100">+</button>
            </div>
            <div class="col-md-1 d-flex align-items-end">
              <button type="button" id="cancelEditBtn" onclick="cancelEdit()" class="btn btn-secondary w-100" style="display: none;">Cancel</button>
            </div>
          </div>
        </form>
        <table class="table table-bordered table-sm mt-4">
          <thead>
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Type</th>
              <th>Values</th>
              <th>Min-Max</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="sensorTableBody"></tbody>
        </table>
      </div>
	  
      <div id="tree" class="section" style="display: none;">
        <h2>Tree</h2>
		<!-- Tree Editor Tab Content -->
		<div id="treeEditorTab" class="tab-pane">
			<div class="mb-4">
				<button class="btn btn-primary me-2" onclick="showAddAreaForm()">Add Area</button>
				<button class="btn btn-secondary me-2" onclick="exportTree()">Export Tree</button>
				<button class="btn btn-secondary" onclick="document.getElementById('importTreeFileInput').click()">Import Tree</button>
				<input type="file" id="importTreeFileInput" accept=".json" style="display:none" onchange="importTree(event)">
			</div>
			<div id="treeContainer"></div>
			<!-- Container for Add/Edit forms -->
			<div id="formContainer"></div>
		</div>
      </div>
	  
      <div id="config" class="section" style="display: none;">
        <h2>Config</h2>
		
		
      </div>
    </div>
  </div>

  <script src="/shared/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
  <script src="tree.js"></script>
  <script>showSection('tree');</script>
</body>
</html>
